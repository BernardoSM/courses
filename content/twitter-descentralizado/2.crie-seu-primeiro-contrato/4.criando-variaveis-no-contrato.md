---
title: Criando variÃ¡veis no contrato
submissionDescription: Envie um print de como ficou a mensagem 'Eu tenho X posts' no seu terminal depois de ter rodado o script 'npx hardhat run scripts/run.js'
submissionContent: Image
---

## Como salvar dados em variÃ¡veis no contrato inteligente

Agora que temos todo nosso ambiente para testar localmente podemos comeÃ§ar colocar a mÃ£o na massa.

Lembre-se que a **blockchain** Ã© como se fosse uma nuvem (AWS, GCP, Azure, etc) e o **contrato inteligente** Ã© como se fosse uma API, ou seja, aqui que vamos escrever as funÃ§Ãµes para serem executadas na blockchain.

Agora vamos atualizar o arquivo `XPost.sol` com os seguintes trechos de cÃ³digo:

```solidity [XPost.sol]{8,15-18,20-23}
// SPDX-License-Identifier: UNLICENSED

pragma solidity ^0.8.19;

import "hardhat/console.sol";

contract XPost {
    uint256 totalPosts;

    constructor() {
        console.log("Eu serei o contrato inteligente para fazer um post no Twitter descentralizado.");
    }

    function createPost() public {
        totalPosts += 1;
        console.log("%s criou o post!", msg.sender);
    }

    function getTotalPosts() public view returns (uint256) {
        console.log("Eu tenho %d posts!", totalPosts);
        return totalPosts;
    }
}
```

Como diria o Rodrigo Goes "Wooow, look at this!". Nesse cÃ³digo criamos duas funÃ§Ãµes, a funÃ§Ã£o de `createPost` que basicamente sÃ³ tÃ¡ aumentando o nÃºmero do `totalPosts` e retornando o endereÃ§o do usuÃ¡rio que criou o post com o `msg.sender`.

SÃ³ lembrando que a variÃ¡vel `totalPosts` Ã© *especial* porque nÃ£o Ã© uma variÃ¡vel comum, ela vai ser inicializada como 0 (zero) quando a gente fizer o deploy do contrato, mas sempre que atualizarmos o contrato em produÃ§Ã£o ela nÃ£o serÃ¡ resetada, ou seja, Ã© como se fosse uma variÃ¡vel mas ao mesmo tempo uma cÃ©lula no banco de dados.

Uma coisa interessante do `msg.sender` Ã© que vocÃª consegue retornar o endereÃ§o da carteira conectada que realizou aquela funÃ§Ã£o, entÃ£o no futuro vocÃª pode criar regras para permitir aÃ§Ãµes somente de uma carteira especÃ­fica.

## Atualizando o script run.js para rodar o cÃ³digo novo

NÃ³s precisamos atualizar as funÃ§Ãµes dentro do arquivo `run.js` pois adicionamos mais coisas no contrato inteligente.

VocÃª pode perceber que dentro do `run.js` tem uma funÃ§Ã£o `waitForDeployment()` e, depois dessa funÃ§Ã£o ser executada, vocÃª pode chamar qualquer funÃ§Ã£o nova que criou no seu contrato inteligente. EntÃ£o vamos fazer as seguintes atualizaÃ§Ãµes:

```js [run.js]{2,7-14}
const main = async () => {
  const [owner] = await hre.ethers.getSigners();
  const xPost = await hre.ethers.deployContract("XPost");
  await xPost.waitForDeployment();

  console.log("Deploy do contrato no endereÃ§o:", xPost.target);
  console.log("Deploy do contrato feito por:", owner.address);

  await xPost.getTotalPosts();

  const waveTxn = await xPost.createPost();
  await waveTxn.wait();

  await xPost.getTotalPosts();
};

const runMain = async () => {
  try {
    await main();
    process.exit(0);
  } catch (error) {
    console.log(error);
    process.exit(1); // Saiba mais sobre a diferenÃ§a de 0 e 1 no exit do node aqui: https://stackoverflow.com/a/47163396/7974948
  }
};

runMain();
```

## O que mudou com essas atualizaÃ§Ãµes? ğŸ¤”

Toda vez que formos subir um contrato inteligente numa blockchain, seja ela local (sua mÃ¡quina) ou nÃ£o, nÃ³s precisaremos usar uma carteira blockchain. 

O hardhat faz esse processo automaticamente, entÃ£o nesse cÃ³digo `const [owner] = await hre.ethers.getSigners();` nÃ³s estamos pegando o endereÃ§o da carteira que o Hardhat usou para fazer o deploy do contrato.

NÃ³s tambÃ©m adicionamos as funÃ§Ãµes `getTotalPosts`, `createPost` e `getTotalPosts` respectivamente. Isso Ã© para mostrar que quando iniciarmos o contrato ele vai ter 0 posts, depois vamos criar um post (que na verdade nÃ£o Ã© um post ainda, sÃ³ incrementar o contador) e vamos verificar que o nÃºmero aumentou depois do post ser criado.

Agora vocÃª vai rodar o script `npx hardhat run scripts/run.js` no seu terminal e vai verificar que a Ãºltima mensagem vai mostrar `Eu tenho 1 posts` como nesse print aqui:

![](../../../images/2023-08-27-16-17-57.png)

> Se vocÃª atualizar o arquivo `run.js` colocando vÃ¡rias funÃ§Ãµes de `createPost`, vocÃª vai verificar que o nÃºmero na mensagem `Eu tenho {nÃºmero} posts` vai atualizar.



