---
title: Integrando o site com a Metamask
submissionDescription: Cole o conte√∫do do arquivo dados.txt ap√≥s ter terminado a aula.
submissionContent: Content
---

## Adicionando as fun√ß√µes de integra√ß√£o com o Metamask

Agora n√≥s vamos adicionar um pouco de javascript (e maizena kkkk) dentro do arquivo `src/App.vue` no projeto `x-front-end`. Ent√£o copie o c√≥digo abaixo e cole no arquivo `App.vue`:

```vue [App.vue] {5-68, 84-85, 92, 95, 98, 102}
<script setup>
import XButton from './components/XButton.vue';
import XTextField from './components/XTextField.vue';
import XPost from './components/XPost.vue';

import { ref, onMounted, watchEffect } from "vue";

const connectedWallet = ref(null);
const loading = ref(false);

const getEthereumObject = () => window.ethereum;

const findMetamaskAccount = async () => {
  loading.value = true;
  try {
    const ethereum = getEthereumObject();

    if (!ethereum) {
      console.error("Instale a extens√£o do Metamask!");
      return null;
    }

    console.log("A extens√£o do Metamask est√° instalada:", ethereum);

    const accounts = await ethereum.request({ method: "eth_accounts" });
    if (accounts.length !== 0) {
      const account = accounts[0];
      console.log("Conta Metamask conectada:", account);
      connectedWallet.value = account;
      return account;
    } else {
      console.error("Nenhuma conta Metamask conectada D:");
      return null;
    }
  } catch (error) {
    console.error(error);
    return null;
  } finally {
    loading.value = false;
  }
};

const connectWallet = async () => {
  loading.value = true;
  try {
    const ethereum = getEthereumObject();
    if (!ethereum) {
      alert("Instale a extens√£o do Metamask!");
      return;
    }

    const accounts = await ethereum.request({
      method: "eth_requestAccounts",
    });

    console.log("Connected", accounts[0]);
    connectedWallet.value = accounts[0];
    getAllWaves();
  } catch (error) {
    console.error(error);
  }
  loading.value = false;
};

onMounted(async() => {
  await findMetamaskAccount();
})

</script>

<template>
  <main
    class="bg-gray-900 min-h-screen flex items-center justify-center flex-col p-20"
  >
    <div
      class="rounded-md border border-gray-700 text-white bg-gray-800 p-6 mx-auto w-full max-w-[600px]"
    >
      <h1 class="text-2xl mb-4">ùïè (Twitter) Descentralizado</h1>
      <p class="text-base mb-4">
        Esse √© um twitter descentralizado, conecte sua sua carteira blockchain e
        use seus Ethereums para enviar uma mensagem. Cada post enviado voc√™ ter√°
        chance de ganhar um valor de Ethereum de volta.
      </p>
      <XButton v-if="!connectedWallet" text="Conectar carteira" @click="connectWallet" :loading="loading" />
      <template v-else>
        <XTextField label="Post" name="post" class="mb-2" type="text" id="post" placeholder="John" required />
        <XButton text="Enviar post" />
        <div class="flex items-center">
          <span
            class="bg-green-100 text-green-800 text-xs font-semibold mr-2 px-2.5 py-0.5 rounded dark:bg-green-200 dark:text-green-900 h-fit"
          >
            Carteira conectada!
          </span>
          <span class="truncate">
            {{ connectedWallet }}
          </span>
        </div>
      </template>
    </div>
    <div
      class="mt-8 rounded-md border border-gray-700 text-white bg-gray-800 p-6 mx-auto w-full max-w-[600px]"
      v-if="connectedWallet"
    >
      <h1 class="text-white text-lg mb-4">Todos os posts</h1>
      <div class="text-center mb-4">Carregando...</div>
      <XPost address="123" timestamp="16:54" message="Descri√ß√£o da mensagem" />
    </div>
  </main>
</template>
```

Eu adicionei uns console.log para voc√™s entenderem o que t√° acontecendo mas, para explicar um pouco mais, n√≥s adicionamos uma fun√ß√£o `getEthereumObject` que vai retornar a vari√°vel global chamada `window.ethereum`. **Essa vari√°vel global s√≥ vai existir se a extens√£o do Metamask estiver instalada no seu computador**.

> **Dica:** para entender um pouco mais como a vari√°vel `window.ethereum` funciona voc√™ pode [acessar a documenta√ß√£o do Metamask](https://docs.metamask.io/wallet/reference/provider-api/?utm_source=menthor.io).

Depois n√≥s criamos uma fun√ß√£o `findMetamaskAccount` e chamamos ela dentro do `onMounted` para verificar se existe uma carteira conectada toda vez que renderizar a p√°gina.

Al√©m disso n√≥s temos a fun√ß√£o principal chamada `connectWallet` que ao execut√°-la vai abrir o pop-up do Metamask para conectar com sua carteira ao site.

Salve as atualiza√ß√µes e rode o projeto com `npm run dev`. Se tudo der certo sua tela dever√° ficar assim:

![](https://raw.githubusercontent.com/menthorlabs/courses/main/images/2023-09-08-19-18-40.png)

## Conectando sua carteira Metamask

Pronto! Agora voc√™ pode clicar no bot√£o azul "Conectar carteira" e dever√° aparecer esse pop-up no seu navegador:

![](https://raw.githubusercontent.com/menthorlabs/courses/main/images/2023-09-08-19-22-04.png)

Clique no bot√£o "Conectar" e seu app dever√° ficar assim:

![](https://raw.githubusercontent.com/menthorlabs/courses/main/images/2023-09-08-19-23-06.png)

Agora √© s√≥ lembrar de enviar tudo para o GitHub como foi explicado [nessa aula aqui](/twitter-descentralizado/desenvolvendo-o-site/instalando-tailwind#salvando-as-atualiza√ß√µes-no-github).

Parab√©ns se chegou at√© aqui! N√£o deixe de compartilhar seu progresso no Twitter ou LinkedIn.

